<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.64.2/dist/instantsearch.production.min.js" integrity="sha256-/DLulTBQ8KQ7xGOs8mrQ6FgKsknJpjCGAjFhjfjc8yo=" crossorigin="anonymous"></script>

<script>
gh_algolia.instant.init = ( instant, algolia ) => {

    let articles_widget = {
        init(){
            let hits = algolia.externals.widgets.hits({
                container: '#gh-ais-hits-article',
                templates: {
                    item(hit, { html, components, sendEvent }) {
                        return html`
                            <a class="ais-hit-gh" href="${hit.url}">
                              <div style="background-image:url(${hit.image})"></div>
                              <div class="article-hit-content left-align">
                                <span class="gh-font-primary bold mb0 color-green-dark block mb1" style="line-height: 1.5">${hit.title}</span>
                                <span class="block gh-ais-article-content">${components.Snippet({ hit, attribute: 'content' })}</span>
                              </div>
                            </div>
                          `;
                    },
                    empty(results, { html }) {
                        return html`<br/><br/><div class="center">No articles found. Try clearing the filters or changing your query.</div><br/><br/>`;
                    },
                },
            });

            let configure = algolia.externals.widgets.configure({
                attributesToSnippet: ['content'],
            });

            let index = instantsearch.widgets.index({indexName: 'wordpress_blog'});
            index.addWidgets([hits, configure])

            instant.search.addWidgets([index]);
        }
    }

  let pages_widget = {
    init(){
      let hits = algolia.externals.widgets.hits({
        container: '#gh-ais-hits-page',
        templates: {
          item(hit, { html, components, sendEvent }) {
            return html`
                <a class="ais-hit-gh" href="https://globalhealing.com/pages/${hit.handle}">
                  <span class="article-hit-content left-align">
                    <span class="flex mb1 items-center" style="line-height: 1.5; gap: 5px;">
                      <span>
                        <img src="https://cdn.globalhealing.com/web/v2/icon/iconmonstr-file-green.png?w=32px" width="16" />
                      </span>
                      <span class="gh-font-primary bold color-green-dark">
                        ${hit.title}
                      </span>
                    </span>
                    <span class="block gh-ais-page-content">${components.Snippet({ hit, attribute: 'body_html_safe' })}</span>
                  </div>
                </div>
              `;
          },
          empty(results, { html }) {
            return html`<br/><br/><div class="center">No pages found. Try clearing the filters or changing your query.</div><br/><br/>`;
          },
        },
      });

      let configure = algolia.externals.widgets.configure({
        attributesToSnippet: ['body_html_safe'],
        hitsPerPage: 3
      });

      let index = instantsearch.widgets.index({indexName: 'shopify_pages'});
      index.addWidgets([hits, configure])

      instant.search.addWidgets([index]);
    }
  }

    instant.search.addWidgets([articles_widget,pages_widget]);
    return instant;

}
</script>